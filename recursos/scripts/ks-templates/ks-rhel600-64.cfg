# Kickstart file automatically generated by anaconda.
#version=RHEL6
install
url --url="http://10.0.51.180/imagenes/rhel600-64/"
lang es_ES.UTF-8
keyboard es
# Reboot after installation
reboot
rootpw  --iscrypted $6$DQtbWZZvOqIC1pRf$6vFUMC9ldrSeLRmTCJTodb8zwUmddomPMdigXJNGAhcLIlmrQYXWvFgelb6XmgGgH6drgooCZd7ztrl6g8D6e0
network  --bootproto=dhcp --device=eth0 --onboot=on --nameserver=192.168.0.254 --hostname=${SERVER}.ife.org.mx --gateway=192.168.0.254
firewall --service=ssh
authconfig --enableshadow --passalgo=sha512 --enablefingerprint
text
selinux --enforcing
services --disabled cups,smartd,nfslock,anacron,autofs,avahi-daemon,avahi-dnsconfd,netplugd,miltipathd,netfs,sasauthd,xfs,xinetd,postfix,portmap
services --enabled iptables,auditd,crond,irqbalance,restorecond,sshd,syslog,sysstat,ntpd,atd,cpuspeed,psacct
# Evitando cualquier configuración mediante interfaz grafica
user --name=admin --groups=admin --shell=/bin/bash --uid=500
user --name=bases --groups=bases --shell=/bin/bash --uid=501
skipx
timezone --utc America/Mexico_City
# Las maquinas las configuramos como base partiendo de 26Gb
bootloader --location=mbr --driveorder=vda --append="crashkernel=auto rhgb quiet" --password=$1$GkRvB0$7xKlR4IG2WMhKCNY3PBTV.
clearpart --all --initlabel
part /boot --asprimary --fstype="ext3" --size=200
part / --asprimary --fstype="ext4" --size=2560
part /var --fstype="ext4" --size=3072
part /var --fstype="ext4" --size=4096
part /tmp --fstype="ext4" --size=2048
part /home --fstype="ext4" --size=3072
part swap --fstype="swap" --size=1024
part swap --fstype="swap" --size=1024
part /usr --fstype="ext4" --size=8192
part /respaldos --fstype="ext4" --grow --size=1
%packages --resolvedeps
# Indicando los paquetes del sistema base
@base
# Indicando los paquetes del sistema core
@core
# Paquetes básicos para indicar que el equipo se comportara como servidor
@server-platform
# Cabeceras de desarrollo y bibliotecas para desarrollar
# aplicaciones para ejecutar en la plataforma de servidor 
# de Red Hat Enterprise Linux.
@server-platform-devel
# Herramientas de soporte de rendimiento para grandes sistemas
@large-systems
# Herramientas para sistemas de diagnóstico y problemas
# de rendimiento a nivel de aplicación.
@performance
# Interfaces de Perl para bibliotecas comunes y funcionalidad. 
@perl-runtime
# Soporte para español
@spanish-support


########### Paquetes individuales ###########
# Administración y actualización del servidor
yum-utils
yum-plugin-aliases
yum-plugin-changelog
yum-plugin-downloadonly
yum-plugin-protect-packages
yum-plugin-security
yum-plugin-tmprepo
yum-plugin-versionlock
yum-plugin-verify
yum-presto

# Herramientas para el analisis en funcionamiento del
# sistema operativo  y monitoreo de recursos
sdparm
sg3_utils
logwatch
uuid
# Manejo de servicios
system-config-firewall-tui
system-config-network-tui
system-config-keyboard
system-config-language

#Autenticación 
nss-pam-ldapd
authconfig
authconfig-gtk
pam_ldap

# Utilerias
dos2unix
unix2dos
x86info
dmidecode
#xWindow
xorg-x11-xauth

# Seguridad y SElinux
tcp_wrappers-libs
tcp_wrappers
libselinux
libselinux-devel
libselinux-utils
libsepol
policycoreutils-python
policycoreutils-gui
policycoreutils
setools-console
setools-libs
setroubleshoot
libsepol-devel
setroubleshoot
-arptables_jf
-arpwatch
-mrtg
-cupsd
%post --log=/root/ks-post-$SERVER.log
# registrando el sistema dentro de Red Hat Network
/usr/sbin/subscription-manager register --username "ricardo.carrillos" --password "c4r.r1ll.0$" --autosubscribe
#/usr/sbin/rhnreg_ks --profilename "$SERVER" --username "ricardo.carrillos" --email "ricardo.carrillo@ife.org.mx" --password "c4r.r1ll.0$" --force
# Aplicando rpm para dar hardening al equipo.
wget -O- http://proxy-or-sat.example.com/pub/bootstrap_script | /bin/bash
#/usr/sbin/rhnreg_ks --activationkey=<activationkey>
%end
